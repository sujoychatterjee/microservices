!function(t,e){var i=t.clone(e.Model.prototype);t.extend(e.Model.prototype,{fileAttribute:"file",save:function(e,r,a){var n,s=this.attributes;if(null==e||"object"==typeof e?(n=e,a=r):(n={})[e]=r,a=t.extend({validate:!0},a),n&&!a.wait){if(!this.set(n,a))return!1}else if(!this._validate(n,a))return!1;if(n&&a.wait&&(this.attributes=t.extend({},s,n)),a.formData===!0||a.formData!==!1&&this.attributes[this.fileAttribute]&&this.attributes[this.fileAttribute]instanceof File){var o=t.clone(this.attributes),f=this.attributes[this.fileAttribute];o=this._flatten(o),o[this.fileAttribute]=f;var l=new FormData;t.each(o,function(t,e){l.append(e,t)}),a=a||{},a.data=l,a.processData=!1,a.contentType=!1;var u=this;a.xhr=function(){var t=$.ajaxSettings.xhr();return t.upload.addEventListener("progress",function(){u._progressHandler.apply(u,arguments)},!1),t}}return n&&a.wait&&(this.attributes=s),i.save.call(this,n,a)},_flatten:function(t){var e={};for(var i in t)if(t.hasOwnProperty(i))if("object"==typeof t[i]){var r=this._flatten(t[i]);for(var a in r)r.hasOwnProperty(a)&&(e[i+"."+a]=r[a])}else e[i]=t[i];return e},_progressHandler:function(t){if(t.lengthComputable){var e=t.loaded/t.total;this.trigger("progress",e)}}})}(_,Backbone);