!function(t){function e(t,e,n){var o=t.children(),r=!1;t.empty();for(var d=0,a=o.length;a>d;d++){var l=o.eq(d);if(t.append(l),n&&t.append(n),i(t,e)){l.remove(),r=!0;break}n&&n.remove()}return r}function n(e,r,d,a,l){var u=e.contents(),c=!1;e.empty();for(var f="table, thead, tbody, tfoot, tr, col, colgroup, object, embed, param, ol, ul, dl, select, optgroup, option, textarea, script, style",s=0,h=u.length;h>s&&!c;s++){var p=u[s],g=t(p);if("undefined"!=typeof p){if(e.append(g),l){var v=e.is(f)?"after":"append";e[v](l)}3==p.nodeType?i(d,a)&&(c=o(g,r,d,a,l)):c=n(g,r,d,a,l),c||l&&l.remove()}}return c}function o(e,n,r,l,u){var c=!1,f=e[0];if("undefined"==typeof f)return!1;for(var s="letter"==l.wrap?"":" ",h=a(f).split(s),p=-1,g=-1,v=0,w=h.length-1;w>=v;){var m=Math.floor((v+w)/2);if(m==g)break;g=m;var y=null;if(l.middleEllipsis){var b=h.length,x=Math.floor(g/2),T=b-x;y=(h.slice(0,x).join(s)+l.ellipsis).trim()+h.slice(T,b).join(s),d(f,y),console.log("midPos="+g+" fullLen="+b+" firstLen="+x+" secondIdx="+T+", middleTruncd='"+y+"'")}else d(f,h.slice(0,g+1).join(s)+l.ellipsis);i(r,l)?w=g:(p=g,v=g)}if(-1!=p){var E=h.slice(0,p+1).join(s);if(c=!0,!y){for(;t.inArray(E.slice(-1),l.lastCharacter.remove)>-1;)E=E.slice(0,-1);t.inArray(E.slice(-1),l.lastCharacter.noEllipsis)<0&&(E+=l.ellipsis),d(f,E)}}else{var I=e.parent();e.remove(),$n=I.contents().eq(-1),c=o($n,n,r,l,u)}return c}function i(t,e){return t.innerHeight()>e.maxHeight}function r(t){return{width:t.innerWidth(),height:t.innerHeight()}}function d(t,e){t.innerText?t.innerText=e:t.nodeValue?t.nodeValue=e:t.textContent&&(t.textContent=e)}function a(t){return t.innerText?t.innerText:t.nodeValue?t.nodeValue:t.textContent?t.textContent:""}function u(e,n){return"undefined"==typeof e?!1:e?"string"==typeof e?(e=t(e,n),e.length?e:!1):"object"==typeof e?"undefined"==typeof e.jquery?!1:e:!1:!1}function c(t){var e=t.innerHeight(),n=["paddingTop","paddingBottom"];for(z=0,l=n.length;z<l;z++){var o=parseInt(t.css(n[z]),10);isNaN(o)&&(o=0),e-=o}return e}function f(t,e){return t?(e="string"==typeof e?"dotdotdot: "+e:["dotdotdot:",e],window.console&&window.console.log&&window.console.log(e),!1):!1}if(!t.fn.dotdotdot){t.fn.dotdotdot=function(o){if(0==this.length)return f(!0,'No element found for "'+this.selector+'".'),this;if(this.length>1)return this.each(function(){t(this).dotdotdot(o)});var d=this;d.data("dotdotdot")&&d.trigger("destroy.dot"),d.bind_events=function(){return d.bind("update.dot",function(o,r){o.preventDefault(),o.stopPropagation(),l.maxHeight="number"==typeof l.height?l.height:c(d),l.maxHeight+=l.tolerance,"undefined"!=typeof r&&(("string"==typeof r||r instanceof HTMLElement)&&(r=t("<div />").append(r).contents()),r instanceof t&&(a=r)),v=d.wrapInner('<div class="dotdotdot" />').children(),v.empty().append(a.clone(!0)).css({height:"auto",width:"auto",border:"none",padding:0,margin:0});var u=!1,f=!1;return h.afterElement&&(u=h.afterElement.clone(!0),h.afterElement.remove()),i(v,l)&&(f="children"==l.wrap?e(v,l,u):n(v,d,v,l,u)),v.replaceWith(v.contents()),v=null,t.isFunction(l.callback)&&l.callback.call(d[0],f,a),h.isTruncated=f,f}).bind("isTruncated.dot",function(t,e){return t.preventDefault(),t.stopPropagation(),"function"==typeof e&&e.call(d[0],h.isTruncated),h.isTruncated}).bind("originalContent.dot",function(t,e){return t.preventDefault(),t.stopPropagation(),"function"==typeof e&&e.call(d[0],a),a}).bind("destroy.dot",function(t){t.preventDefault(),t.stopPropagation(),d.unwatch().unbind_events().empty().append(a).data("dotdotdot",!1)}),d},d.unbind_events=function(){return d.unbind(".dot"),d},d.watch=function(){if(d.unwatch(),"window"==l.watch){var e=t(window),n=e.width(),o=e.height();e.bind("resize.dot"+h.dotId,function(){n==e.width()&&o==e.height()&&l.windowResizeFix||(n=e.width(),o=e.height(),g&&clearInterval(g),g=setTimeout(function(){d.trigger("update.dot")},10))})}else p=r(d),g=setInterval(function(){var t=r(d);(p.width!=t.width||p.height!=t.height)&&(d.trigger("update.dot"),p=r(d))},100);return d},d.unwatch=function(){return t(window).unbind("resize.dot"+h.dotId),g&&clearInterval(g),d};var a=d.contents(),l=t.extend(!0,{},t.fn.dotdotdot.defaults,o),h={},p={},g=null,v=null;return h.afterElement=u(l.after,d),h.isTruncated=!1,h.dotId=s++,d.data("dotdotdot",!0).bind_events().trigger("update.dot"),l.watch&&d.watch(),d},t.fn.dotdotdot.defaults={ellipsis:"... ",middleEllipsis:!1,wrap:"word",lastCharacter:{remove:[" ",",",";",".","!","?"],noEllipsis:[]},tolerance:0,callback:null,after:null,height:null,watch:!1,windowResizeFix:!0,debug:!1};var s=1,h=t.fn.html;t.fn.html=function(t){return"undefined"!=typeof t?this.data("dotdotdot")&&"function"!=typeof t?this.trigger("update",[t]):h.call(this,t):h.call(this)};var p=t.fn.text;t.fn.text=function(e){if("undefined"!=typeof e){if(this.data("dotdotdot")){var n=t("<div />");return n.text(e),e=n.html(),n.remove(),this.trigger("update",[e])}return p.call(this,e)}return p.call(this)}}}(jQuery);